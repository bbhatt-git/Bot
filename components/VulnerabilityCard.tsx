import React from 'react';
import { Vulnerability } from '../types';
import { AlertTriangle, ShieldAlert, Code, MapPin } from 'lucide-react';

interface Props {
  vuln: Vulnerability;
}

const VulnerabilityCard: React.FC<Props> = ({ vuln }) => {
  const getSeverityColor = (severity: string) => {
    switch (severity) {
      case 'CRITICAL': return 'bg-red-900/30 text-red-500 border-red-500/50';
      case 'HIGH': return 'bg-orange-900/30 text-orange-500 border-orange-500/50';
      case 'MEDIUM': return 'bg-yellow-900/30 text-yellow-500 border-yellow-500/50';
      default: return 'bg-blue-900/30 text-blue-500 border-blue-500/50';
    }
  };

  return (
    <div className={`p-4 rounded-lg border ${getSeverityColor(vuln.severity)} mb-3 relative overflow-hidden group`}>
       <div className="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
         <ShieldAlert size={48} />
       </div>

      <div className="flex justify-between items-start mb-2">
        <div className="flex items-center space-x-2">
          <AlertTriangle size={18} />
          <h3 className="font-bold text-lg tracking-tight">{vuln.type}</h3>
        </div>
        <span className="text-xs font-mono px-2 py-1 rounded bg-black/40 border border-white/10">
          {vuln.severity}
        </span>
      </div>

      <p className="text-sm opacity-90 mb-3">{vuln.description}</p>

      <div className="space-y-1 text-xs font-mono">
        <div className="flex items-center space-x-2 text-white/60">
            <MapPin size={12} />
            <span>{vuln.location}</span>
        </div>
        {vuln.payload_used && (
            <div className="flex items-center space-x-2 text-white/60">
                <Code size={12} />
                <span className="truncate max-w-[300px]">{vuln.payload_used}</span>
            </div>
        )}
      </div>
    </div>
  );
};

export default VulnerabilityCard;